sudo: true
language: cpp

matrix:
  include:
    - os: linux
      compiler: gcc
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test']
          packages: ['g++-4.9', 'libssl-dev', 'libpng12-dev', 'libboost-dev', 'libsnappy-dev']
      env: TOOLSET=gcc-4.9
      before_script:
        - "echo -e 'using gcc : 4.9 : g++-4.9 ;' > ~/user-config.jam"

    #- os: linux
      #compiler: gcc
      #addons:
        #apt:
          #sources: ['ubuntu-toolchain-r-test']
          #packages: ['g++-5', 'libssl-dev', 'libpng12-dev', 'libboost-dev', 'libsnappy-dev']
      #env: TOOLSET=gcc-5.0
      #before_script:
        #- "echo -e 'using gcc : 5.0 : '$(which g++-5)' ;' > ~/user-config.jam"

    #- os: linux
      #compiler: clang
      #addons:
        #apt:
          #sources: ['ubuntu-toolchain-r-test', 'llvm-toolchain-precise-3.5']
          #packages: ['clang-3.5', 'libssl-dev', 'libpng12-dev', 'libboost-dev', 'libsnappy-dev']
      #env: TOOLSET=clang-3.5 NO_MAKE_CONFIG=1
      #before_script:
        #- "echo -e 'using clang : : clang++ : <cxxflags>-Qunused-arguments' > ~/user-config.jam"

    #- os: linux
      #compiler: clang
      #addons:
        #apt:
          #sources: ['ubuntu-toolchain-r-test', 'llvm-toolchain-precise-3.6']
          #packages: ['clang-3.6', 'libc++1', 'libc++-dev', 'libssl-dev', 'libpng12-dev', 'libboost-dev', 'libsnappy-dev']
      #env: TOOLSET=clang-3.6 NO_MAKE_CONFIG=1 CXXFLAGS=cxxflags=-stdlib=libc++
      #before_script:
        #- "echo -e 'using clang : : clang++ : <cxxflags>-Qunused-arguments' > ~/user-config.jam"
                
    #- os: osx
      #compiler: clang
      #addons:
        #apt:
          #packages: ['libssl-dev', 'libpng12-dev', 'libboost-dev', 'libsnappy-dev']
      #env: TOOLSET=clang
      #before_script:
        #- "echo -e 'using clang : : clang++ : <cxxflags>-Qunused-arguments' > ~/user-config.jam"

script:
  - sudo cp tools/bjam-patch/clang-linux.jam /usr/share/boost-build/tools/clang-linux.jam
  - bjam linkflags=-c --toolset=$TOOLSET $CXXFLAGS -q exe


#branches:
#  only:
#    - master

notifications:
  email:
    recipients:
      - jpoelen@wallix.com
      - rzhou@wallix.com
      - cgrosjean@wallix.com
      #- jinthavong@wallix.com
      #- mtan@wallix.com
    on_success: never
    on_failure: always
